{% extends 'travel_app/base.html' %}

{% block title %}–õ–µ–Ω—Ç–∞ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è{% endblock %}

{% block extra_styles %}

<style>
    body {
        font-family: 'Montserrat', sans-serif;
        background-color: #f5f5f5;
    }
    .inspiration-feed {
        max-width: 1200px;
        margin: 50px auto;
        padding: 20px;
    }
    .post-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
    }
    .post-card {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s;
        cursor: pointer;
    }
    .post-card:hover {
        transform: translateY(-5px);
    }
    .post-image img {
        width: 100%;
        height: 200px;
        object-fit: cover;
    }
    .post-content {
        padding: 15px;
    }
    .post-content h4 {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 10px;
    }
    .post-content p {
        font-size: 14px;
        color: #666;
        margin-bottom: 10px;
    }
    .post-content small {
        color: #999;
    }
    .btn-create-post {
        display: block;
        width: 200px;
        margin: 20px auto;
        background: linear-gradient(45deg, #ff6b6b, #ff8e53);
        color: white;
        text-align: center;
        padding: 10px;
        border-radius: 10px;
        text-decoration: none;
        font-weight: 500;
    }
    .btn-create-post:hover {
        background: linear-gradient(45deg, #ff8e53, #ff6b6b);
        color: white;
    }
    .btn-save-post, .btn-like-post {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 18px;
        margin-left: 10px;
    }
    .btn-save-post {
        color: #ff6b6b;
    }
    .btn-save-post:hover {
        color: #ff8e53;
    }
    .btn-like-post {
        color: #ff6b6b;
    }
    .btn-like-post.liked {
        color: #ff2d55;
    }
    .btn-like-post:hover {
        color: #ff8e53;
    }
    .likes-count {
        font-size: 14px;
        color: #666;
        margin-left: 10px;
    }
    .tags, .vibes {
        margin-top: 10px;
        font-size: 13px;
    }
    .tags span, .vibes span {
        background: #ff8e53;
        color: white;
        padding: 3px 8px;
        border-radius: 5px;
        margin-right: 5px;
        display: inline-block;
    }
</style>
{% endblock %}

{% block content %}
<div class="inspiration-feed">
    <h2 class="text-center mb-4 heading-separator">–õ–µ–Ω—Ç–∞ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è</h2>
    {% if user.is_authenticated %}
        <a href="{% url 'create_inspiration_post' %}" class="btn-create-post">–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</a>
    {% endif %}
    <div class="post-grid">
        {% for post in posts %}
            <div class="post-card glass-effect" data-post-id="{{ post.id }}">
                <div class="post-image">
                    <img src="{{ post.image.url }}" alt="{{ post.description|truncatechars:50 }}">
                </div>
                <div class="post-content">
                    <h4>
                        {% if post.destination %}
                            {{ post.destination.recommendation }}
                        {% else %}
                            {{ post.pending_destination.name }}
                        {% endif %}
                    </h4>
                    {% if post.description %}
                        <p>{{ post.description|truncatechars:100 }}</p>
                    {% endif %}
                    {% if post.tags.all %}
                        <div class="tags">
                            {% for tag in post.tags.all %}
                                <span>{{ tag.name }}</span>
                            {% endfor %}
                        </div>
                    {% endif %}
                    {% if post.vibe.all %}
                        <div class="vibes">
                            {% for vibe in post.vibe.all %}
                                <span>{{ vibe.name }}</span>
                            {% endfor %}
                        </div>
                    {% endif %}
                    <div style="display: flex; align-items: center;">
                        <small>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {{ post.created_at|date:"d.m.Y" }} | {{ post.user.username }}</small>
                        <span class="likes-count">–õ–∞–π–∫–æ–≤: {{ post.likes.count }}</span>
                        {% if user.is_authenticated and user != post.user %}
                            <form method="post" action="{% url 'save_post' post.id %}" style="display: inline;">
                                {% csrf_token %}
                                <input type="hidden" name="next" value="{{ request.path }}">
                                <button type="submit" class="btn-save-post" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ">üíæ</button>
                            </form>
                            <form method="post" action="{% url 'toggle_like_post' post.id %}" style="display: inline;">
                                {% csrf_token %}
                                <input type="hidden" name="next" value="{{ request.path }}">
                                <button type="submit" class="btn-like-post {% if user in post.likes.all %}liked{% endif %}" title="–õ–∞–π–∫">‚ù§Ô∏è</button>
                            </form>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

{% include 'travel_app/modal_post.html' %}
{% endblock %}